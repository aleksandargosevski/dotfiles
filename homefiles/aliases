# List files
alias ls="lsd"
alias la="ls -la"
alias ll="ls -l"

alias tl="tmux ls"
alias ta="tmux attach"
alias trestart="rm ~/.tmux/resurrect/*.txt && rm ~/.tmux/resurrect/last && tmux kill-server && tc dotfiles"
function tk () { tmux kill-session -t $1 }
function tc () { tmux new -s $1 }

# Nvim
alias nvim="TERM='' nvim"
alias v='nvim'
alias vim="nvim"

function nvims() {
  items=("default" "kickstart" "LazyVim" "NvChad" "AstroNvim" "LunarVim")
  config=$(printf "%s\n" "${items[@]}" | fzf --prompt=" Neovim Config  " --height=~50% --layout=reverse --border --exit-0)
  if [[ -z $config ]]; then
    echo "Nothing selected"
    return 0
  elif [[ $config == "default" ]]; then
    config=""
  fi
  NVIM_APPNAME=$config nvim $@
}

bindkey -s ^a "nvims\n"

# Reload
alias re="source ~/.zshrc"

# Edit hosts
alias hos="sudo -E nvim /etc/hosts"
alias hoc="sudo sed -i '' '11,\$d' /etc/hosts"

# Read markdown
rmd () {
  grep -v "\-\-\-\-\-" "$*" | pandoc -s -f markdown -t man | groff -T utf8 -man | less
}

# Calendar events
function ev () {
  if [ $1 ]; then
    daysToAdd=$1
  else
    daysToAdd=0
  fi

  icalBuddy -f -npn -iep 'title,datetime' -ps '| : |' -po 'datetime,title' -eed eventsToday+$daysToAdd
}

# Weather
alias we="curl http://wttr.in/\?m"

# asciinema rec
alias rec="asciinema rec"

# Imgur upload
alias img="imgur-screenshot.sh -l true"

# Unrar all .rar files in current folder
alias unrarall='find ./ -name "*.rar" -execdir unrar e {} \;'

# Back folders
alias .="cd ../"
alias ..="cd ../../"
alias ...="cd ../../../"
alias ....="cd ../../../../"

# Folders
alias sites="cd ~/Sites"
alias akordi="cd ~/My\ Drive/Akordi && nvim"
alias a="cd ~/My\ Drive/Akordi && gfind . -type f -printf '%T@ %p\n' | sort -k 1 -n -r | sed 's/^[^ ]* //' | grep -v .DS_Store| fzf"
alias down="cd ~/Downloads"
alias desk="cd ~/Desktop"
alias drive="cd ~/My\ Drive"
alias dotf="cd ~/dotfiles"

# Folder sizes
alias sizes="du -xhd1 | sort -n"

# Youtube Download
alias mp3="youtube-dl -x --audio-format mp3 --audio-quality 0"
# Get OS X Software Updates, and update installed Ruby gems, Homebrew, npm, and their installed packages
alias update="softwareupdate -i -a; brew update; brew upgrade"

# IP addresses
alias ip="dig +short myip.opendns.com @resolver1.opendns.com"
alias localip="ipconfig getifaddr en0"

# Brew cleanup & Flush Directory Service cache & Empty the Trash on all mounted volumes and main HDD & Clear Apple’s System Logs
alias cleanup="brew cleanup; dscacheutil -flushcache; killall -HUP mDNSResponder; rm -rfv /Volumes/*/.Trashes; rm -rfv ~/.Trash; sudo rm -rfv /private/var/log/asl/*.asl"

# Clean install of node modules
alias mylog="nodemon server.js | grep --line-buffered 'MYLOG'"
alias ni="rm -rf node_modules; npm i"
alias nrd="pkill node && npm run dev"
alias nis="npm i --save"
alias nid="npm i --save-dev"
alias yi="yarn install"
alias yis="yarn add"
alias yid="yarn add --dev"

# Docker
alias dlc="docker ps -a"
alias dsc="docker stop"
alias dcc='docker stop $(docker ps -a -q) && docker rm $(docker ps -a -q)'
alias drc="docker rm"
alias dli="docker images"
alias dri="docker rmi"
alias dci='docker rmi $(docker images -a -q)'

# Vagrant
alias vup="vagrant up"
alias vdes="vagrant destroy"
alias vres="vagrant destroy && vagrant up"
alias vssh="vagrant ssh"

# kill procces chooser
function kp () {
  PRC=${1:-"[n]ode"}
  ps | grep $PRC | fzf | cut -d" " -f 1 | xargs kill -9
}

alias gd="git dsf"
alias ga="git add ."
function gcm () {
  git commit -m $1
}
alias lg="git fuzzy status"
alias grhh="git reset head --hard"
alias gco="git checkout"
alias gup='git fetch -p && git pull --rebase && git branch --merged | egrep -v "(^\*|master|dev|main)" | xargs git branch -d'
# alias ts="tig status"
alias gst="git status --short"
alias gcom="git log --no-merges --pretty=%an | head -n 100 | sort | uniq -c | sort -nr"
alias glog="git log --graph --pretty=format:'%Cred%h%Creset %C(bold blue)%an%C(reset) - %s - %Creset %C(yellow)%d%Creset %Cgreen(%cr)%Creset' --abbrev-commit --date=relative"
alias gwip='git add -A; git commit --no-verify --no-gpg-sign -m "--wip-- [skip ci]"'
alias gsquash='git reset HEAD~$(git rev-list --count main..HEAD)'
function ggp () {
  git push origin $(git branch --show-current)
}
function ggpf () {
  git push origin $(git branch --show-current) --force
}
function retag () {
  git tag -d $1 && git push origin :refs/tags/$1 && git tag $1
}
function git_prepare() {
  if [ -n "$BUFFER" ]; then
    BUFFER="git add -A && git commit -m \"$BUFFER\""
  fi

  if [ -z "$BUFFER" ]; then
    BUFFER="git add -A && git commit -v"
  fi

  zle accept-line
}
zle -N git_prepare
bindkey "^g" git_prepare

# history
function h () {
  print -z $( ([ -n "$ZSH_NAME" ] && fc -l 1 || history) | fzf +s --tac | sed 's/ *[0-9]* *//')
}

# JSON pretty print
alias json='python -m json.tool'

# Url Encode/Decode
alias decode='python -c "import sys, urllib as ul; print ul.unquote_plus(sys.argv[1])"'
alias encode='python -c "import sys, urllib as ul; print ul.quote_plus(sys.argv[1])"'

# JSON to YAML and vice versa
alias jty="python -c 'import sys, yaml, json; yaml.safe_dump(json.load(sys.stdin), sys.stdout, default_flow_style=False)' < $1"
alias ytj="ruby -ryaml -rjson -e 'puts JSON.pretty_generate(YAML.load(ARGF))' < $1"
